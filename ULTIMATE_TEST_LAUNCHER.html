<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• ULTIMATE SYSTEM VALIDATOR - NO BULLSHIT TESTING</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', monospace;
            background: #000;
            color: #64ff96;
            padding: 20px;
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #64ff96;
            padding-bottom: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 900;
            text-shadow: 0 0 20px #64ff96;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #a8e6a3;
            font-weight: 400;
        }

        .warning-box {
            background: rgba(255, 100, 100, 0.1);
            border: 2px solid #ff6464;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #ff9999;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .test-card {
            background: rgba(20, 20, 40, 0.8);
            border: 1px solid #64ff96;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .test-card:hover {
            border-color: #a8e6a3;
            background: rgba(20, 20, 40, 0.9);
        }

        .test-card h3 {
            color: #64ff96;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .test-card p {
            color: #a8e6a3;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .btn {
            background: linear-gradient(145deg, #64ff96, #4a9960);
            border: none;
            color: #001a0a;
            padding: 12px 24px;
            border-radius: 6px;
            font-family: 'Orbitron', monospace;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn:hover {
            background: linear-gradient(145deg, #7cffae, #5eab74);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(100, 255, 150, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-danger {
            background: linear-gradient(145deg, #ff6464, #cc4444);
            color: #fff;
        }

        .btn-danger:hover {
            background: linear-gradient(145deg, #ff7c7c, #dd5555);
        }

        .results-panel {
            background: rgba(10, 10, 25, 0.9);
            border: 1px solid #64ff96;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            max-height: 600px;
            overflow-y: auto;
        }

        .results-panel h3 {
            color: #64ff96;
            margin-bottom: 15px;
            text-align: center;
        }

        .console-output {
            background: #000;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #64ff96;
            white-space: pre-wrap;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-loading { background: #ffb464; animation: pulse 1s infinite; }
        .status-success { background: #64ff96; }
        .status-error { background: #ff6464; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .progress-bar {
            background: rgba(100, 255, 150, 0.1);
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #64ff96, #a8e6a3);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .quick-actions .btn {
            flex: 1;
            min-width: 150px;
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .control-panel {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .quick-actions .btn {
                flex: none;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üî• ULTIMATE SYSTEM VALIDATOR</h1>
        <div class="subtitle">NO BULLSHIT TESTING - VALIDATES REAL FUNCTIONALITY</div>
    </div>

    <div class="warning-box">
        <strong>‚ö†Ô∏è WARNING:</strong> This testing system will generate synthetic audio data, simulate user interactions, 
        and stress-test all visualization systems. It tests ACTUAL functionality, not just "does object exist" checks.
        Make sure the main VIB34D system is loaded first!
    </div>

    <div class="quick-actions">
        <button class="btn" onclick="loadMainSystem()">üöÄ Load Main System</button>
        <button class="btn" onclick="runFullValidation()">üî• RUN ULTIMATE VALIDATION</button>
        <button class="btn btn-danger" onclick="runStressTest()">üí• STRESS TEST MODE</button>
        <button class="btn" onclick="clearResults()">üßπ Clear Results</button>
    </div>

    <div class="control-panel">
        <div class="test-card">
            <h3>üéµ Audio Reactivity Testing</h3>
            <p>Tests REAL audio reactivity by generating synthetic audio data and verifying visual changes occur in each system.</p>
            <div class="status">
                <span class="status-indicator status-loading" id="audioStatus"></span>
                <span id="audioStatusText">Ready</span>
            </div>
            <button class="btn" onclick="testAudioOnly()">Test Audio Systems</button>
        </div>

        <div class="test-card">
            <h3>üñ±Ô∏è Interaction Testing</h3>
            <p>Tests REAL mouse, touch, and keyboard interactions by simulating user input and verifying system responses.</p>
            <div class="status">
                <span class="status-indicator status-loading" id="interactionStatus"></span>
                <span id="interactionStatusText">Ready</span>
            </div>
            <button class="btn" onclick="testInteractionsOnly()">Test Interactions</button>
        </div>

        <div class="test-card">
            <h3>üîÑ System Switching</h3>
            <p>Tests REAL system switching by verifying all 4 systems display correctly and render without errors.</p>
            <div class="status">
                <span class="status-indicator status-loading" id="systemStatus"></span>
                <span id="systemStatusText">Ready</span>
            </div>
            <button class="btn" onclick="testSystemSwitching()">Test System Switching</button>
        </div>

        <div class="test-card">
            <h3>‚ö° Performance Testing</h3>
            <p>Tests REAL performance by monitoring FPS and frame times under heavy load with synthetic interactions.</p>
            <div class="status">
                <span class="status-indicator status-loading" id="performanceStatus"></span>
                <span id="performanceStatusText">Ready</span>
            </div>
            <button class="btn" onclick="testPerformanceOnly()">Test Performance</button>
        </div>

        <div class="test-card">
            <h3>üí• Error Recovery</h3>
            <p>Tests REAL error handling by intentionally breaking things and verifying recovery mechanisms work.</p>
            <div class="status">
                <span class="status-indicator status-loading" id="errorStatus"></span>
                <span id="errorStatusText">Ready</span>
            </div>
            <button class="btn btn-danger" onclick="testErrorRecovery()">Test Error Recovery</button>
        </div>

        <div class="test-card">
            <h3>üì± Mobile Experience</h3>
            <p>Tests REAL mobile experience by simulating different viewports and touch interactions.</p>
            <div class="status">
                <span class="status-indicator status-loading" id="mobileStatus"></span>
                <span id="mobileStatusText">Ready</span>
            </div>
            <button class="btn" onclick="testMobileOnly()">Test Mobile</button>
        </div>
    </div>

    <div class="results-panel">
        <h3>üß™ TEST RESULTS & CONSOLE OUTPUT</h3>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
        <div class="console-output" id="consoleOutput">
Ready to run tests. Click "RUN ULTIMATE VALIDATION" to test all systems, or run individual tests above.

üî• WHAT THIS TESTING SYSTEM DOES:

‚úÖ AUDIO REACTIVITY: Generates synthetic audio data (bass, mid, high frequencies) and verifies visuals actually change
‚úÖ INTERACTION TESTING: Simulates real mouse, touch, and keyboard events and validates system responses  
‚úÖ VISUAL VALIDATION: Captures canvas pixel data before/after changes to detect real visual differences
‚úÖ PERFORMANCE MONITORING: Measures actual FPS and frame times under realistic load conditions
‚úÖ ERROR RECOVERY: Intentionally breaks systems and verifies they recover gracefully
‚úÖ MOBILE TESTING: Simulates different device viewports and touch interactions

This is NOT superficial "does object exist" testing - this validates REAL FUNCTIONALITY.
        </div>
    </div>

    <script type="module">
        import { UltimateSystemValidator } from './src/test/UltimateSystemValidator.js';

        let validator = null;
        let mainSystemLoaded = false;
        
        // Global functions for button clicks
        window.loadMainSystem = async () => {
            updateConsole('üöÄ Loading main VIB34D system...');
            
            try {
                // Create iframe to load main system
                const iframe = document.createElement('iframe');
                iframe.src = './index.html';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                
                // Wait for main system to load
                await new Promise((resolve) => {
                    iframe.onload = () => {
                        // Access the iframe's window
                        const iframeWindow = iframe.contentWindow;
                        
                        // Wait for systems to be ready
                        const checkSystems = () => {
                            if (iframeWindow.engine && iframeWindow.universalAudio && iframeWindow.universalInteractions) {
                                // Copy systems to main window for testing
                                window.engine = iframeWindow.engine;
                                window.quantumEngine = iframeWindow.quantumEngine;
                                window.holographicSystem = iframeWindow.holographicSystem;
                                window.polychoraSystem = iframeWindow.polychoraSystem;
                                window.universalAudio = iframeWindow.universalAudio;
                                window.universalInteractions = iframeWindow.universalInteractions;
                                window.switchSystem = iframeWindow.switchSystem;
                                
                                mainSystemLoaded = true;
                                updateConsole('‚úÖ Main VIB34D system loaded successfully!');
                                resolve();
                            } else {
                                setTimeout(checkSystems, 100);
                            }
                        };
                        checkSystems();
                    };
                });
                
            } catch (error) {
                updateConsole(`‚ùå Failed to load main system: ${error.message}`);
            }
        };
        
        window.runFullValidation = async () => {
            if (!mainSystemLoaded) {
                updateConsole('‚ö†Ô∏è Please load main system first!');
                return;
            }
            
            updateConsole('üî• STARTING ULTIMATE VALIDATION - TESTING REAL FUNCTIONALITY\n');
            updateProgress(0);
            
            try {
                validator = new UltimateSystemValidator();
                const results = await validator.runUltimateValidation();
                
                updateProgress(100);
                updateConsole('\nüéâ ULTIMATE VALIDATION COMPLETE!');
                updateConsole(`Results: ${results.passedTests}/${results.totalTests} tests passed (${results.successRate}%)`);
                
                if (results.success) {
                    updateConsole('\n‚úÖ ALL SYSTEMS ARE ACTUALLY WORKING CORRECTLY!');
                    updateAllStatus('success');
                } else {
                    updateConsole('\n‚ùå CRITICAL ISSUES DETECTED:');
                    results.criticalFailures.forEach(failure => {
                        updateConsole(`  - ${failure}`);
                    });
                    updateAllStatus('error');
                }
                
            } catch (error) {
                updateConsole(`üí• Validation failed: ${error.message}`);
                updateAllStatus('error');
            }
        };
        
        window.runStressTest = async () => {
            if (!mainSystemLoaded) {
                updateConsole('‚ö†Ô∏è Please load main system first!');
                return;
            }
            
            updateConsole('üí• RUNNING STRESS TEST - MAXIMUM LOAD CONDITIONS\n');
            
            // Simulate heavy load for 10 seconds
            const duration = 10000;
            const startTime = performance.now();
            
            const stressTest = () => {
                // Rapid system switching
                const systems = ['faceted', 'quantum', 'holographic', 'polychora'];
                const randomSystem = systems[Math.floor(Math.random() * systems.length)];
                if (window.switchSystem) window.switchSystem(randomSystem);
                
                // Heavy audio injection
                if (window.universalAudio) {
                    const randomAudio = {
                        bass: Math.random(),
                        mid: Math.random(),
                        high: Math.random(),
                        energy: Math.random()
                    };
                    
                    if (window.universalAudio.audioFeatures) {
                        Object.assign(window.universalAudio.audioFeatures, randomAudio);
                    }
                }
                
                // Heavy interaction simulation
                if (window.universalInteractions) {
                    const interactions = window.universalInteractions;
                    interactions.mouse.x = Math.random();
                    interactions.mouse.y = Math.random();
                    interactions.mouse.intensity = Math.random();
                }
                
                if (performance.now() - startTime < duration) {
                    requestAnimationFrame(stressTest);
                } else {
                    updateConsole('‚úÖ Stress test completed - system survived 10 seconds of maximum load');
                }
            };
            
            stressTest();
        };
        
        // Individual test functions
        window.testAudioOnly = async () => {
            if (!validator) validator = new UltimateSystemValidator();
            await validator.testRealAudioReactivity();
            updateConsole('üéµ Audio reactivity testing complete');
        };
        
        window.testInteractionsOnly = async () => {
            if (!validator) validator = new UltimateSystemValidator();
            await validator.testRealInteractionSystems();
            updateConsole('üñ±Ô∏è Interaction testing complete');
        };
        
        window.testSystemSwitching = async () => {
            if (!validator) validator = new UltimateSystemValidator();
            await validator.testRealSystemSwitching();
            updateConsole('üîÑ System switching testing complete');
        };
        
        window.testPerformanceOnly = async () => {
            if (!validator) validator = new UltimateSystemValidator();
            await validator.testRealPerformance();
            updateConsole('‚ö° Performance testing complete');
        };
        
        window.testErrorRecovery = async () => {
            if (!validator) validator = new UltimateSystemValidator();
            await validator.testErrorRecovery();
            updateConsole('üí• Error recovery testing complete');
        };
        
        window.testMobileOnly = async () => {
            if (!validator) validator = new UltimateSystemValidator();
            await validator.testMobileExperience();
            updateConsole('üì± Mobile experience testing complete');
        };
        
        window.clearResults = () => {
            document.getElementById('consoleOutput').textContent = 'Console cleared. Ready for new tests.';
            updateProgress(0);
            updateAllStatus('loading');
        };
        
        function updateConsole(message) {
            const output = document.getElementById('consoleOutput');
            output.textContent += message + '\n';
            output.scrollTop = output.scrollHeight;
        }
        
        function updateProgress(percent) {
            document.getElementById('progressFill').style.width = percent + '%';
        }
        
        function updateStatus(elementId, status) {
            const statusElement = document.getElementById(elementId);
            statusElement.className = `status-indicator status-${status}`;
        }
        
        function updateAllStatus(status) {
            const statuses = ['audioStatus', 'interactionStatus', 'systemStatus', 'performanceStatus', 'errorStatus', 'mobileStatus'];
            statuses.forEach(id => updateStatus(id, status));
        }

        // Auto-load main system on page load
        window.addEventListener('load', () => {
            updateConsole('üî• ULTIMATE SYSTEM VALIDATOR READY\nClick "Load Main System" to begin testing.');
        });
    </script>
</body>
</html>